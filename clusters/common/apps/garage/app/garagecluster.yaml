---
apiVersion: garage.rajsingh.info/v1alpha1
kind: GarageCluster
metadata:
  name: garage
spec:
  replicas: 1
  zone: "${LOCATION}"

  replication:
    factor: 3
    zoneRedundancy: "AtLeast(2)"

  storage:
    metadata:
      size: 1Gi
    data:
      size: 100Gi
      storageClassName: "${STORAGECLASS_LONGTERM}"

  network:
    rpcSecretRef:
      name: garage-rpc-secret
      key: rpc-secret

  remoteClusters:
    - name: ottawa
      zone: ottawa
      connection:
        adminApiEndpoint: "http://ottawa-garage:3903"
        adminTokenSecretRef:
          name: garage-admin-token
          key: admin-token
    - name: robbinsdale
      zone: robbinsdale
      connection:
        adminApiEndpoint: "http://robbinsdale-garage:3903"
        adminTokenSecretRef:
          name: garage-admin-token
          key: admin-token
    - name: stpetersburg
      zone: stpetersburg
      connection:
        adminApiEndpoint: "http://stpetersburg-garage:3903"
        adminTokenSecretRef:
          name: garage-admin-token
          key: admin-token

  admin:
    adminTokenSecretRef:
      name: garage-admin-token
      key: admin-token

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 1Gi
